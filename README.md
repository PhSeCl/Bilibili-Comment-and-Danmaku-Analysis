# ä¸­å±±å¤§å­¦äººå·¥æ™ºèƒ½å­¦é™¢æ•°æ®åˆ†æå®è·µå¤§ä½œä¸š

æœ¬é¡¹ç›®æ˜¯ä¸­å±±å¤§å­¦äººå·¥æ™ºèƒ½å­¦é™¢æ•°æ®åˆ†æå®è·µè¯¾ç¨‹çš„å¤§ä½œä¸šï¼Œè¯¥é¡¹ç›®çš„å†…å®¹æ˜¯çˆ¬å–åˆ°æ•°æ®é›†è¿›è¡Œæ•°æ®åˆ†æå’Œå¯è§†åŒ–å±•ç¤ºã€‚

## ğŸ“‚ é¡¹ç›®ç»“æ„

```text
Bilibili-Comment-Analysis/ (æ ¹ç›®å½•)
â”œâ”€â”€ data/                        # å­˜æ”¾æ•°æ®æ–‡ä»¶
â”‚   â”œâ”€â”€ raw/                     # åŸå§‹æ•°æ®
â”‚   â”‚   â”œâ”€â”€ comments_BVxx.csv         # çˆ¬å–çš„è¯„è®ºæ•°æ®
â”‚   â”‚   â””â”€â”€ danmaku_BVxx.csv          # çˆ¬å–çš„å¼¹å¹•æ•°æ®
â”‚   â””â”€â”€ processed/               # é¢„å¤„ç†åçš„æ•°æ®
â”‚       â”œâ”€â”€ comment_tokenized_dataset/ # HFæ ¼å¼çš„Tokenizedæ•°æ®é›†
â”‚       â””â”€â”€ comment_loc2id.json  # åœ°ç‚¹æ˜ å°„è¡¨
â”‚
â”œâ”€â”€ src/                         # æºä»£ç  (Source Code)
â”‚   â”œâ”€â”€ analysis/                # æ ¸å¿ƒåˆ†æä¸æ¨¡å‹æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ model.py             # æ¨¡å‹æ¨ç†æ¥å£
â”‚   â”‚   â””â”€â”€ run_prediction.py    # æ¨¡å‹è°ƒç”¨è„šæœ¬
â”‚   â”‚
â”‚   â”œâ”€â”€ crawler/                 # çˆ¬è™«æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ config.py            # çˆ¬è™«é…ç½® (Cookieç­‰)
â”‚   â”‚   â””â”€â”€ main_crawler.py      # çˆ¬è™«ä¸»ç¨‹åº
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/                   # é€šç”¨å·¥å…·åº“
â”‚   â”‚
â”‚   â””â”€â”€ visualization/           # å¯è§†åŒ–æ¨¡å—
â”‚
â”œâ”€â”€ docs/                        # æ–‡æ¡£ä¸äº§å‡º
â”‚   â”œâ”€â”€ images/                  # å­˜æ”¾ç”Ÿæˆçš„å›¾è¡¨å›¾ç‰‡
â”‚   â””â”€â”€ ...
â”œâ”€â”€ README.md                    # é¡¹ç›®è¯´æ˜ä¹¦
â””â”€â”€ requirements.txt             # ä¾èµ–åŒ…åˆ—è¡¨
```

---

## ğŸ“Š åŠŸèƒ½ä¸å¯è§†åŒ–æ¶æ„

### æ ¸å¿ƒåŠŸèƒ½äº®ç‚¹

- **å¤šç»´åº¦æƒ…æ„Ÿåˆ†æ**ï¼šæ”¯æŒæ—¶é—´ã€åœ°åŸŸã€ç”¨æˆ·ç­‰çº§ç­‰ç»´åº¦çš„æƒ…æ„Ÿåˆ†æã€‚
- **äº¤äº’å¼å¯è§†åŒ–**ï¼šé€šè¿‡ Streamlit æä¾›ç›´è§‚çš„äº¤äº’ç•Œé¢ã€‚
- **è‡ªå®šä¹‰æ•°æ®çˆ¬å–**ï¼šæ”¯æŒç”¨æˆ·è‡ªå®šä¹‰çˆ¬å– B ç«™è¯„è®ºå’Œå¼¹å¹•æ•°æ®ã€‚

### æ ¸å¿ƒå·¥ä½œæµ

```åŸå§‹è¯„è®º/å¼¹å¹•æ•°æ®
  â†’ æ•°æ®é¢„å¤„ç† 
  â†’ æƒ…æ„Ÿåˆ†ç±» 
  â†’ å¤šç»´åº¦å¯è§†åŒ–
```

### æ•°æ®è¾“å‡ºæ ¼å¼è§„èŒƒ

#### è¯„è®ºæ•°æ®è¾“å‡ºæ ¼å¼

```csv
rpid,username,level,content,likes,location,date,emotion_code,emotion_label
247633504176,æ‹‰æ™®å…°å¾·ä¸å­¤ç‹¬,6,æˆ‘æ˜¯éª‘å£«å—ï¼Ÿ,1244,å¹¿ä¸œ,2024-11-20 21:56:54,2,positive
```

| å­—æ®µ | è¯´æ˜ | æ•°æ®ç±»å‹ | å¤‡æ³¨ |
|------|------|---------|------|
| `rpid` | è¯„è®º ID | int | åŸå§‹æ•°æ® |
| `username` | ç”¨æˆ·å | str | åŸå§‹æ•°æ® |
| `level` | ç”¨æˆ·ç­‰çº§ | int | åŸå§‹æ•°æ® |
| `content` | è¯„è®ºå†…å®¹ | str | åŸå§‹æ•°æ® |
| `likes` | ç‚¹èµæ•° | int | åŸå§‹æ•°æ® |
| `location` | åœ°åŸŸ IP | str | åŸå§‹æ•°æ® |
| `date` | å‘å¸ƒæ—¶é—´ | datetime | åŸå§‹æ•°æ® |
| `emotion_code` | æƒ…æ„Ÿä»£ç  | int | **æ–°å¢** 0-7ï¼ˆ8åˆ†ç±»ï¼‰ |
| `emotion_label` | æƒ…æ„Ÿæ ‡ç­¾ | str | **æ–°å¢** positive/neutral/negative ç­‰ |

#### å¼¹å¹•æ•°æ®è¾“å‡ºæ ¼å¼

```csv
danmaku_id,user_hash,content,real_time,video_time,emotion_code,emotion_label
1,user_abc123,å¼¹å¹•å†…å®¹,2024-11-20 21:56:54,01:23:45,3,neutral
```

| å­—æ®µ | è¯´æ˜ | æ•°æ®ç±»å‹ | å¤‡æ³¨ |
|------|------|---------|------|
| `danmaku_id` | å¼¹å¹• ID | int | åŸå§‹æ•°æ® |
| `user_hash` | ç”¨æˆ· Hash | str | åŸå§‹æ•°æ® |
| `content` | å¼¹å¹•å†…å®¹ | str | åŸå§‹æ•°æ® |
| `real_time` | å‘å¸ƒç°å®æ—¶é—´ | datetime | åŸå§‹æ•°æ®ï¼ˆå¯åˆ†æè§†é¢‘èƒŒæ™¯ï¼‰ |
| `video_time` | è§†é¢‘æ’­æ”¾æ—¶é—´ | str (HH:MM:SS) | åŸå§‹æ•°æ®ï¼ˆå¯åˆ†æè§†é¢‘å†…å®¹ï¼‰ |
| `emotion_code` | æƒ…æ„Ÿä»£ç  | int | **æ–°å¢** 0-7ï¼ˆ8åˆ†ç±»ï¼‰ |
| `emotion_label` | æƒ…æ„Ÿæ ‡ç­¾ | str | **æ–°å¢** positive/neutral/negative ç­‰ |

---

## ä½¿ç”¨è¯´æ˜

- å…‹éš†é¡¹ç›®åˆ°æœ¬åœ°ï¼š

   ```bash
   git clone https://github.com/PhSeCl/Bilibili-Comment-and-Danmaku-Analysis.git
   cd Bilibili-Comment-and-Danmaku-Analysis
   ```

- å®‰è£…ä¾èµ–åŒ…ï¼š

   ```bash
   pip install -r requirements.txt
   ```

- é…ç½®çˆ¬è™«å‚æ•°ï¼š

   åœ¨ `src/crawler/config.py` ä¸­è®¾ç½® B ç«™ Cookie ã€‚(Cookie è·å–æ–¹æ³•è¯·å‚è€ƒç½‘ç»œæ•™ç¨‹)

- è¿è¡Œ GUI ç•Œé¢ï¼š

   ```bash
   streamlit run app.py
   ```

- æŒ‰ç…§ç•Œé¢æç¤ºè¿›è¡Œæ•°æ®çˆ¬å–ã€åˆ†æä¸å¯è§†åŒ–ã€‚
  
## æ³¨æ„äº‹é¡¹

- å¦‚æœCookieå¤±æ•ˆï¼Œå¯èƒ½å¯¼è‡´æ— æ³•çˆ¬å–æ•°æ®ï¼Œè¯·åŠæ—¶æ›´æ–°ã€‚
- è¯·ç¡®ä¿ç½‘ç»œè¿æ¥ç•…é€šï¼Œä»¥ä¾¿é¡ºåˆ©çˆ¬å– B ç«™æ•°æ®ã€‚
- çˆ¬å–æ•°æ®æ—¶è¯·éµå®ˆ B ç«™çš„ä½¿ç”¨æ¡æ¬¾ï¼Œé¿å…è¿‡äºé¢‘ç¹çš„è¯·æ±‚å¯¼è‡´å°ç¦ã€‚
- åˆ†æè¿‡ç¨‹ä¸­å¯èƒ½ä¼šæ¶ˆè€—è¾ƒå¤šè®¡ç®—èµ„æºï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´æ‰¹å¤„ç†å¤§å°ç­‰å‚æ•°ã€‚
- å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨é¡¹ç›®çš„ GitHub é¡µé¢æäº¤ issue æˆ– pull requestï¼Œæˆ–è”ç³» [xuhch28@mail2.sysu.edu.cn](mailto:xuhch28@mail2.sysu.edu.cn)
